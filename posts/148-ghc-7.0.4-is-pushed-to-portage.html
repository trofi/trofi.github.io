<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>ghc-7.0.4 is pushed to portage</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/code.css" />
        <link rel="stylesheet" type="text/css" href="../css/skylighting.css" />

        <link rel="alternate" type="application/atom+xml" href="../feed/atom.xml" title="Atom 1.0" />
        <link rel="alternate" type="application/rss+xml" href="../feed/rss.xml" title="RSS 2.0" />
        <link rel="shortcut icon" href="../images/favicon.ico" />
    </head>
    <body>
        <div id="navigation">
            <a href="../">home</a>
            <a href="../blog.html">blog</a>
            <a href="../log.html">log</a>
            <a href="../feed/atom.xml">atom</a>
            <a href="../feed/rss.xml">rss</a>
            <a href="../about.html">about</a>
            <a href="../contact.html">contact</a>
        </div>

        <div id="content">
            <h1>ghc-7.0.4 is pushed to portage</h1>
            
                <div class="info">August  6, 2011</div>
            

            <p><a href="http://www.haskell.org/pipermail/glasgow-haskell-users/2011-June/020494.html">15 Июня 2011 года вышел <code>ghc-7.0.4</code></a>.
В оверлее он появился <a href="https://github.com/gentoo-haskell/gentoo-haskell/commit/d5386478a4493d698ee18f40dc52cc6784fdffa1">в тот же
день</a>.
Это хорошая традиция.</p>
<p>Подготовка <code>ghc</code> к добавлению его в основное дерево <code>gentoo-x86</code>
заняла почти 2 месяца. На самом деле это очень быстро. До этого были
(традиционно неюзабельные) релизы <code>ghc</code> <code>7.0.1</code>, <code>7.0.2</code> и
<code>7.0.3</code>, основываясь на которых мы уже слали патчи в разные апстримы,
которые ломаются с каждой новой мажорной версией <code>ghc</code>. Так что к
релизу <code>7.0.4</code> у нас всё более-менее собиралось.</p>
<p>В этот раз серьезным изменением было выбрасывание <code>base-3</code> и
обновление <code>Cabal</code> до <code>1.10</code> (появился <a href="http://www.haskell.org/cabal/release/cabal-1.10.1.0/doc/users-guide/#test-suites">новый интерфейс для
тестов</a>).</p>
<p>Основным подстёгивающим фактором быстренько запушить <code>ghc-7.0.4</code> в
<code>portage</code> явился только-только вышедший (и уже попавший в оверлей!)
релиз-кандидат <code>ghc-7.2.1</code>. Судя по всему это уже вторая традиция.</p>
<p>Как показывает практика до версии <code>7.2.3</code> пользоваться им будет нельзя.</p>
<p>Уже сейчас в ветке <code>7.2</code> сломаны:</p>
<ul>
<li><code>template haskell</code> (частично починен): <a href="http://hackage.haskell.org/trac/ghc/ticket/5362">баг
#5362</a></li>
<li><code>unregisterised build</code> (есть шанс, что починен, проверим в
<code>-rc2</code>): <a href="http://hackage.haskell.org/trac/ghc/ticket/5357">баг
#5357</a></li>
<li><code>text</code> (починен): <a href="http://hackage.haskell.org/trac/ghc/ticket/5359">баг
#5359</a></li>
</ul>
<p>И это только проблемы <code>ghc</code>, а еще остальные пакеты надо фиксить.</p>
<p>Правда, основные уже подправлены в оверлее и ждут, когда патчи к ним
отправятся в <code>upstream</code>ы. Тут даже
<a href="https://github.com/gentoo-haskell/gentoo-haskell/blob/master/projects/doc/TODO.rst">написано</a>,
как их (патчи) найти.</p>
<p>С релизом <code>ghc-7.0.4</code> мы потеряли поддержку <code>ia64</code>. Бинарник <code>ghc</code>
настолько велик, что статические данные переполняют 24-разрядную
<code>gprel</code> адресацию, а <code>gcc</code> для поддержки <code>-mcmodel=medium</code> я еще
не допилил.</p>
<p>Но теперь есть кое-какой билд для <code>arm</code>!</p>
        </div>
    </body>
</html>
